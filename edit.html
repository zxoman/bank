<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>Sir.Hamdi</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon">
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.gstatic.com" rel="preconnect">
    <link
        href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
        rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css"
        integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.3.0/font/bootstrap-icons.css">

    <script src="/ckeditor/ckeditor.js"></script>
    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet">

</head>

<body>

    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top d-flex align-items-center">

        <div class="d-flex align-items-center justify-content-between">
            <a href="" class="logo d-flex align-items-center">
                <img src="assets/img/logo.png" alt="">
                <span class="d-none d-lg-block">Sir.Hamdi</span>
            </a>
            <i class="bi bi-list toggle-sidebar-btn"></i>
        </div><!-- End Logo -->
        <nav class="header-nav ms-auto">
            <ul class="d-flex align-items-center">
                <li class="nav-item dropdown">
                    <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
                        <i class="bi bi-bell"></i>
                        <span class="badge bg-primary badge-number">4</span>
                    </a><!-- End Notification Icon -->
                </li><!-- End Notification Nav -->
                <li class="nav-item dropdown">
                    <a class="nav-link nav-icon" href="#" data-bs-toggle="dropdown">
                        <i class="bi bi-chat-left-text"></i>
                        <span class="badge bg-success badge-number">3</span>
                    </a><!-- End Messages Icon -->
                <li class="nav-item dropdown pe-3">
                    <a class="nav-link nav-profile d-flex align-items-center pe-0" href="#" data-bs-toggle="dropdown">
                        <img src="assets/img/profile-img.jpg" alt="Profile" class="rounded-circle">
                        <span class="d-none d-md-block dropdown-toggle ps-2">Sir. Hamdi</span>
                    </a><!-- End Profile Iamge Icon -->
                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow profile">
                        <li class="dropdown-header">
                            <h6>Sir. Hamdi</h6>
                            <span>Chemistry Maestro</span>
                        </li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                    </ul><!-- End Profile Dropdown Items -->
                </li><!-- End Profile Nav -->
            </ul>
        </nav><!-- End Icons Navigation -->
    </header><!-- End Header -->
    <aside id="sidebar" class="sidebar">
        <ul class="sidebar-nav" id="sidebar-nav">

            <li class="nav-item">
                <a class="nav-link collapsed" href="add.html">
                    <i class="bi bi-grid"></i>
                    <span>Add Question
                    </span>
                </a>
                <a class="nav-link collapsed" href="print.html">
                    <i class="bi bi-grid"></i>
                    <span>Print Exams
                    </span>
                </a>
                <a class="nav-link collapsed" href="data.html">
                    <i class="bi bi-grid"></i>
                    <span>Bank Exams
                    </span>
                </a>
            </li>

        </ul>
    </aside>
    <main id="main" class="main" style="text-align:center;">

        <div class="pagetitle">
            <h1>Form Editors</h1>
        </div><!-- End Page Title -->
        <div class="card">
            <div class="card-body">
                <h5 class="card-title">Select Options</h5>

                <!-- No Labels Form -->
                <form class="row g-3" action="#">

                    <div class="col-md-4">
                        <select id="inputState" name="class" class="form-select">
                            <option selected value="">الصف</option>
                            <option value="1">الأول الثانوي</option>
                            <option value="2">الثاني الثانوي</option>
                            <option value="3">الثالث الثانوي</option>
                            <option value="1d">الأول الإعدادي</option>
                            <option value="2d">الثاني الإعدادي</option>
                            <option value="3d">الثالث الإعدادي</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="inputState" name="term" class="form-select">
                            <option selected>الترم</option>
                            <option value="1">الأول</option>
                            <option value="2">الثاني</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="inputState" name="unit" class="form-select">
                            <option selected>الباب</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="inputState" name="lesson" class="form-select">
                            <option value="" selected>الدرس</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="inputState" name="difficulty" class="form-select">
                            <option selected value="">الصعوبه</option>
                            <option value="0">سهلة</option>
                            <option value="1">متوسط</option>
                            <option value="2">صعبة</option>
                        </select>
                    </div>
                    <div class="col-md-4">
                        <select id="type" onchange="select_type(this)" name="type" class="form-select">
                            <option selected value="">النوع</option>
                            <option value="choices">اختياري</option>
                            <option value="text">مقالي</option>
                        </select>
                    </div>
                    <section class="section">
                        <div class="col-lg-6" style="width:100%;">
                            <div class="card">
                                <div class="card-body">
                                    <h5 class="card-title">السؤال</h5>
                                    <div id="text">
                                        <div class="q">
                                            <div>زياد السيد</div>
                                        </div>
                                        <div class="ans">
                                            <div class="a">
                                                <div>زياد السيد</div>
                                            </div>
                                            <div class="a">
                                                <div>زياد السيد</div>
                                            </div>
                                            <div class="a">
                                                <div>زياد السيد</div>
                                            </div>
                                            <div class="a">
                                                <div>زياد السيد</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
            </div>
            </section>
            <textarea name="answer_text" id="text_area" cols="30" rows="10"></textarea>

            <div id="choices">
                <div class="ansf col-md-6">
                    <input type="text" disabled class="form-control" placeholder="ب"><input type="radio" value="2"
                        name="ans" id="ans-2">
                </div> 
              
                <div class="ansf col-md-6">
                    <input type="text" disabled class="form-control" placeholder="ا"><input type="radio" value="1"
                        name="ans" id="ans-1">
                </div>                

                <div class="ansf col-md-6">
                    <input type="text" disabled class="form-control" placeholder="د"><input type="radio" value="4"
                        name="ans" id="ans-4">
                </div>                
                <div class="ansf col-md-6">
                    <input type="text" disabled class="form-control" placeholder="ج"><input type="radio" value="3"
                        name="ans" id="ans-3">
                </div> 

            </div>
            <br>
            <div class="text-center">
                <button type="button" onclick="save()" class="btn btn-primary">Save</button>
            </div>
            </form><!-- End No Labels Form -->
        </div>
        </div>
    </main><!-- End #main -->
    <!-- ======= Footer ======= -->
    <footer id="footer" class="footer">
        <div class="copyright">
            &copy; Copyright <strong><span>Devoco</span></strong>. All Rights Reserved
        </div>
        <div class="credits">
            Power by <a href="https://wa.me/+201017465981">Ahmed ElSaka & </a><a href="https://wa.me/+201064704303">Ziad
                Elsayed</a>
        </div>
    </footer><!-- End Footer -->
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
            class="bi bi-arrow-up-short"></i></a>
    <!-- Vendor JS Files -->
    <script src="https://cdn.socket.io/4.5.0/socket.io.min.js"
        integrity="sha384-7EyYLQZgWBi67fBtVxw60/OWl1kjsfrPFcaU0pp0nAh+i8FD068QogUvg85Ewy1k"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.1.min.js"></script>
    <script src="assets/js/main.js"></script>
    <script>
        var select_type = (e, z = null) => {
            console.log(e.value);
            if (e.value == "text") {
                $("#choices").hide();
                $("#text_area").show();
                if (z != null) {
                    $("#text_area").val(z);
                }
            } else {
                $("#choices").show();
                $("#text_area").hide();
                if (z != null) {
                    $("#ans-" + z).attr('checked', true);
                }
            }
        };
        function get_src() {
            var data = CKEDITOR.instances.text.getData();
            return data;
        }

        var socket = io("http://localhost:3000");
        const urlSearchParams = new URLSearchParams(window.location.search);
        const params = Object.fromEntries(urlSearchParams.entries())
        var form = document.forms[0].elements;
        socket.on("get_data", (d) => {
            form.class.value = d[0].class;
            form.term.value = d[0].term;
            form.unit.value = d[0].unit;
            form.lesson.value = d[0].lesson;
            form.difficulty.value = d[0].difficulty;
            form.type.value = d[0].type_a;
            $('#text').html(d[0].text);
            select_type(form.type, d[0].answer);
            console.log(d);
        });
        socket.emit("get_data", { id: params.id });
        save = () => {
            info = {
                class: form.class.value,
                term: form.term.value,
                unit: form.unit.value,
                lesson: form.lesson.value,
                difficulty: form.lesson.difficulty,
                type_a: form.type.value,
                text: get_src()
            }
            if ($("#type").val() == "text") {
                info.answer = $("#text_area").val();
            } else {
                info.answer = $("input:radio[name=ans]:checked").val();
            }
            socket.emit("edit", {
                id: params.id, info: info
            });
        }
    </script>
</body>

</html>